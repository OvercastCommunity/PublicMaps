<map>
<!-- Global constants -->
<constants fallback="true">
    <constant id="deny-shield-crafting">true</constant>
</constants>

<!-- Selectively prevent seasonal variants from sponsoring -->
<if has-variant="halloween">
    <if variant="halloween">
        <phase>staging</phase>
    </if>
</if>
<if has-variant="christmas">
    <if variant="default">
        <phase>staging</phase>
    </if>
</if>

<!-- Add maxbuildheight variable to pre-proto 1.5 maps -->
<variables>
    <maxbuildheight id="maxbuildheight"/>
</variables>

<!-- Modern only changes (from OCN global include) -->
<if min-server-version="1.21.1">
    <!-- Increase default attack speed -->
    <spawns>
        <player-kit>
            <!-- TODO: verify if rounding errors still problematic -->
            <attribute operation="multiply" amount="4.001">generic.attackSpeed</attribute> <!-- exactly 4 causes rounding errors -->
        </player-kit>
    </spawns>

    <!-- Modify speed, durability, protection, etc. of axes and armour -->
    <item-mods>
        <rule>
            <match>
                <material>wood axe</material>
            </match>
            <modify>
                <attribute amount="2" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>gold axe</material>
            </match>
            <modify>
                <attribute amount="2" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>stone axe</material>
            </match>
            <modify>
                <attribute amount="3" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>iron axe</material>
            </match>
            <modify>
                <attribute amount="4" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>diamond axe</material>
            </match>
            <modify>
                <attribute amount="5" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>netherite axe</material>
            </match>
            <modify>
                <attribute amount="6" slot="mainhand">attack_damage</attribute>
                <attribute amount="-2.5" slot="mainhand">attack_speed</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>leather helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="1" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>leather chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>leather leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="2" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>leather boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="1" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>gold helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="2" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>gold chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="5" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>gold leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>gold boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="1" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>chainmail helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="2" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>chainmail chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="5" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>chainmail leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="4" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>chainmail boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="1" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>iron helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="2" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>iron chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="6" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>iron leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="5" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>iron boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="2" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>diamond helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>diamond chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="8" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>diamond leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="6" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>diamond boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>netherite helmet</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="head">armor</attribute>
                <attribute amount="400" slot="head">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>netherite chestplate</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="8" slot="chest">armor</attribute>
                <attribute amount="400" slot="chest">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>netherite leggings</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="6" slot="legs">armor</attribute>
                <attribute amount="400" slot="legs">armor_toughness</attribute>
            </modify>
        </rule>
        <rule>
            <match>
                <material>netherite boots</material>
            </match>
            <modify show-attributes="false">
                <attribute amount="3" slot="feet">armor</attribute>
                <attribute amount="400" slot="feet">armor_toughness</attribute>
            </modify>
        </rule>
    </item-mods>
    
    <!-- Disable shield crafting by default, re-evaluate later -->
    <if constant="deny-shield-crafting" constant-value="true">
        <crafting>
            <disable>shield</disable>
        </crafting>
    </if>
</if>
</map>